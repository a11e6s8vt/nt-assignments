% Assignment1 - Ajeesh T. Vijayan
\documentclass[11pt,a4paper,fleqn]{article}
\usepackage[utf8]{inputenc}
\usepackage{array}
\usepackage{caption}
\usepackage{enumerate}
\usepackage{amsmath, amssymb,amsthm}
\usepackage{array, makecell}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage[left=2.5cm,right=1.5cm,top=2cm,bottom=1.5cm]{geometry}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{fancyhdr}
\usepackage[colorlinks=true]{hyperref}
\usepackage{listings, lstautogobble}
\usepackage{listings-rust}
\usepackage[verbatim]{lstfiracode}
\usepackage[table, x11names]{xcolor}
\usepackage{fontawesome5}
\usepackage{adjustbox}
\usepackage{tabularx, makecell, booktabs}%
\usepackage{maple}
\usepackage{breqn}
\usepackage{textcomp}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{mathtools}
\usepackage{maple}
\usepackage[utf8]{inputenc}
\usepackage[svgnames]{xcolor}
\usepackage{breqn}
\usepackage{verbatimbox,caption,float,lipsum}
\usepackage{mdframed}
\newfloat{Code}
\captionsetup{Code}

%New colors defined below
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

%Code listing style named "mystyle"
\lstdefinestyle{mystyle}{
	mathescape=true,
	language=Rust,
	backgroundcolor=\color{backcolour},
	style=FiraCodeStyle,
	commentstyle=\color{codegreen},
	keywordstyle=\color{magenta},
	numberstyle=\tiny\color{codegray},
	stringstyle=\color{codepurple},
	basicstyle=\ttfamily\small,
	breakatwhitespace=false,
	breaklines=true,
	captionpos=b,
	keepspaces=true,
	numbers=left,
	numbersep=3pt,
	showspaces=false,
	showstringspaces=false,
	showtabs=false,
	tabsize=2
}

%"mystyle" code listing set
\lstset{style=mystyle}

\lstdefinestyle{DOS}
{
	backgroundcolor=\color{black},
	basicstyle=\scriptsize\color{white}\ttfamily
}

\colorlet{punct}{red!60!black}
\definecolor{background}{HTML}{EEEEEE}
\definecolor{delim}{RGB}{20,105,176}
\colorlet{numb}{magenta!60!black}

\lstdefinelanguage{json}{
	mathescape=true,
	basicstyle=\normalfont\ttfamily,
	numbers=left,
	numberstyle=\scriptsize,
	stepnumber=1,
	numbersep=8pt,
	showstringspaces=false,
	breaklines=true,
	frame=lines,
	backgroundcolor=\color{background},
	literate=
	*{0}{{{\color{numb}0}}}{1}
	{1}{{{\color{numb}1}}}{1}
	{2}{{{\color{numb}2}}}{1}
	{3}{{{\color{numb}3}}}{1}
	{4}{{{\color{numb}4}}}{1}
	{5}{{{\color{numb}5}}}{1}
	{6}{{{\color{numb}6}}}{1}
	{7}{{{\color{numb}7}}}{1}
	{8}{{{\color{numb}8}}}{1}
	{9}{{{\color{numb}9}}}{1}
	{:}{{{\color{punct}{:}}}}{1}
	{,}{{{\color{punct}{,}}}}{1}
	{\{}{{{\color{delim}{\{}}}}{1}
	{\}}{{{\color{delim}{\}}}}}{1}
	{[}{{{\color{delim}{[}}}}{1}
	{]}{{{\color{delim}{]}}}}{1},
}

\lstnewenvironment{myverbatim}[1][]{%
	\lstset{
		basicstyle=\ttfamily,
		frame=tb,
		#1
	}%
}{}

\makeatletter
\newcommand{\github}[1]{%
	\href{#1}{\faGithubSquare}%
}
\makeatother

\makeatletter
\newcommand{\tpmod}[1]{{\@displayfalse\pmod{#1}}}
\makeatother

\newtheorem{theorem}{Theorem}
\newcommand{\qedn}{\tag*{$\blacksquare$}}
\renewcommand{\qedsymbol}{$\blacksquare$}


% Define typographic struts, as suggested by Claudio Beccari
%   in an article in TeX and TUG News, Vol. 2, 1993.
\newcommand\Tstrut{\rule{0pt}{2.6ex}}         % = `top' strut
\newcommand\Bstrut{\rule[-0.9ex]{0pt}{0pt}}   % = `bottom' strut

\captionsetup[table]{position=bottom}   %% or below

\pagestyle{fancy}
\lhead{Ajeesh T. Vijayan}
\rhead{Student No: 22077273}
\cfoot{\thepage}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}

\title{MA7010 – Number Theory for Cryptography - Assignment 3}
\author{Ajeesh Thattukunnel Vijayan}
\date{January 11\textsuperscript{th} 2024}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

\newcommand{\roverline}[1]{\mathpalette\doroverline{#1}}
\newcommand{\doroverline}[2]{\overline{#1#2}}
\setcounter{MaxMatrixCols}{20}

\begin{document}
\lstset{basicstyle=\ttfamily,breaklines=true,columns=flexible}
\pagestyle{empty}
\DefineParaStyle{Maple Bullet Item}
\DefineParaStyle{Maple Heading 1}
\DefineParaStyle{Maple Warning}
\DefineParaStyle{Maple Heading 4}
\DefineParaStyle{Maple Heading 2}
\DefineParaStyle{Maple Heading 3}
\DefineParaStyle{Maple Dash Item}
\DefineParaStyle{Maple Error}
\DefineParaStyle{Maple Title}
\DefineParaStyle{Maple Ordered List 1}
\DefineParaStyle{Maple Text Output}
\DefineParaStyle{Maple Ordered List 2}
\DefineParaStyle{Maple Ordered List 3}
\DefineParaStyle{Maple Normal}
\DefineParaStyle{Maple Ordered List 4}
\DefineParaStyle{Maple Ordered List 5}
\DefineCharStyle{Maple 2D Output}
\DefineCharStyle{Maple 2D Input}
\DefineCharStyle{Maple Maple Input}
\DefineCharStyle{Maple 2D Math}
\DefineCharStyle{Maple Hyperlink}
	\maketitle
	\section{Introduction}
	\begin{table}[H]
		\begin{adjustbox}{scale=0.9,center}
			\begin{tabular}{ |p{2cm}|p{2cm}|p{2cm}|p{2cm}|p{2cm}|p{2cm}| }
				\hline
				Name & a & b & c & d & Q6 \\
				\hline
				Ajeesh & $2929$   & $20953$   & $500657$   & $23861$ & ii \\
				\hline
			\end{tabular}
		\end{adjustbox}
		\caption{Input Numbers For Ajeesh}
		\label{table:assignment-tab}
	\end{table}
	\section{Answers} \label{sec:Forces}

	\begin{enumerate}[1.]
		\item For the number $a$ given to you on page 1 answer the following:
		\begin{enumerate}[a.]
			\item Show that $a$ can be written as the sum of squares in two different ways
			\bigskip
			\begin{flushleft}
				\textbf{\textit{Answer:}}
                \begin{align*}
                    &a = 2929 \\
                    &\text{Let } u = 5, v = 2, w = 10, x = 1\\
                    &\text{Brahmagupta Identity helps us to write this numbers in two different sum of squares form}\\
                    &(u^2 + v^2)(w^2 + x^2) = (uw - vx)^2 + (ux + vw)^2\\
                    &                       = (uw + vx)^2 + (ux - vw)^2\\
                    &\therefore (uw - vx)^2 + (ux + vw)^2 = (5 \times 10 - 2 \times 1)^2 + (5 \times 1 + 2\times 10)^2 = 48^2 + 25^2 \\
                    &\text{and }  (uw + vx)^2 + (ux - vw)^2 = (5 \times 10 + 2 \times 1)^2 + (5 \times 1 - 2 \times 10)^2 = 52^2 + (-15)^2\\
                    &\text{Hence the two different sum of squares forms of 2929 are: }\\
                    &2929 = 48^2 + 25^2\\
                    &2929 = 52^2 + 15^2  \hfill\qedn
                \end{align*}
			\end{flushleft}
			\item Hence apply Euler’s method to factorise $a$.
			\begin{flushleft}
				\textbf{\textit{Answer:}}
                \begin{align*}
                    &\text{From 1.(a) above, we have }\\
                    &2929 = 48^2 + 25^2 = a^2 + b^2\\
                    &2929 = 52^2 + 15^2 = c^2 + d^2\\
                    &\therefore a^2 + b^2 = c^2 + d^2\\
                    &\implies a^2 - c^2 = b^2 - d^2\\
                    &\implies (a - c)(a + c) = (b - d)(b + d)\\
               \end{align*}
               \begin{align*}
                    &\text{Let } k = gcd(a - c, b + d) \text{ and } h = gcd(a + c, b + d)\\
                    &\therefore k = 2 \text{ and } h = 20\\
                    &\implies a - c =  k.l \implies 4 = 2 \times l \implies l = 2\\
                    &b - d = k.m \implies 10 = 2 \times m \implies m = 5\\
                    &a + c = h.m' \implies 100 = 20 \times m' \implies m' = 5\\
                    &b + d = h.l' \implies 40 = 20 \times l' \implies l' = 2\\
                    &\therefore n = 2929 = ((\frac{k}{2})^2 + (\frac{h}{2})^2)(l^2 + m^2)\\
                    & = (1^2 + 10^2)(2^2 + 5^2) = (101 \times 29)
                    \hfill\qedn
                \end{align*}
			\end{flushleft}
		\end{enumerate}
		\item
		\begin{enumerate}[(a)]
			\item Take the number $b$ assigned to you on page 1 and apply the gcd method to find its smallest factor.
			\begin{flushleft}
				\textbf{\textit{Answer:}}
                \begin{align*}
                    & b = 20953\\
                    &\text{Set } k = \lfloor\sqrt{b}\rfloor = 144\\
                    &P_0 = \prod_{primes < 144}^{}p = 10014646650599190067509233131649940057366334653200433090\\
                    &gcd(10014646650599190067509233131649940057366334653200433090, 20953) = 23, \\
                    &\text{which is the smallest factor of 20953}.
                    \hfill\qedn
                \end{align*}
                \bigbreak
                The Maple worksheet for this exercise is below:
                \begin{mdframed}
                    \mapleinput
                    {$ \displaystyle \texttt{>\,} \mathit{p0} \coloneqq 1 $}

                    % \mapleresult
                    \begin{dmath}\label{(1)}
                        \mathit{p0} \coloneqq 1
                    \end{dmath}
                    \mapleinput
                    {$ \displaystyle \texttt{>\,} k \coloneqq 2; $}

                    % \mapleresult
                    \begin{dmath}\label{(2)}
                        k \coloneqq 2
                    \end{dmath}
                    \mapleinput
                    {$ \displaystyle \texttt{>\,} \mathrm{while}\,k \,<\,144\,\mathrm{do} \,\mathit{p0} \coloneqq \mathit{p0} \cdot k ;
                        \\
                        \,k \coloneqq \mathit{nextprime} (k);
                        \\
                        \,\mathrm{od}; $}

                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 2
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 3
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 6
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 5
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 30
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 7
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 210
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 11
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 2310
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 13
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 30030
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 17
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 510510
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 19
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 9699690
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 23
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 223092870
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 29
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 6469693230
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 31
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 200560490130
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 37
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 7420738134810
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 41
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 304250263527210
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 43
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 13082761331670030
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 47
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 614889782588491410
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 53
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 32589158477190044730
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 59
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 1922760350154212639070
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 61
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 117288381359406970983270
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 67
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 7858321551080267055879090
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 71
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 557940830126698960967415390
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 73
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 40729680599249024150621323470
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 79
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 3217644767340672907899084554130
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 83
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 267064515689275851355624017992790
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 89
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 23768741896345550770650537601358310
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 97
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 2305567963945518424753102147331756070
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 101
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 232862364358497360900063316880507363070
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 103
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 23984823528925228172706521638692258396210
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 107
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 2566376117594999414479597815340071648394470
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 109
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 279734996817854936178276161872067809674997230
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 113
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 31610054640417607788145206291543662493274686990
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 127
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 4014476939333036189094441199026045136645885247730
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 131
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 525896479052627740771371797072411912900610967452630
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 137
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 72047817630210000485677936198920432067383702541010310
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        k \coloneqq 139
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath*}
                        \mathit{p0} \coloneqq 10014646650599190067509233131649940057366334653200433090
                    \end{dmath*}
                    \vspace{-\bigskipamount}
                    % \mapleresult
                    \begin{dmath}\label{(3)}
                        k \coloneqq 149
                    \end{dmath}
                    \mapleinput
                    {$ \displaystyle \texttt{>\,} \mathit{igcd} (10014646650599190067509233131649940057366334653200433090,20953) $}

                    % \mapleresult
                    \begin{dmath}\label{(4)}
                        23
                    \end{dmath}
                    \mapleinput
                    {$ \displaystyle \texttt{>\,} \, $}
                \end{mdframed}
			\end{flushleft}
			\item What is the value of $P_0$ that you need to guarantee finding a factor given that $b$ is composite?
			\begin{flushleft}
				\textbf{\textit{Answer:}} From the Maple worksheet from 2(a), the $P_0$ value that guarantee a minimum factor is the product of all primes upto $23$ inclusive of $23$. Hence the required $P0 = 223092870$ \qed
			\end{flushleft}
		\end{enumerate}
		\item Take the number $c$ assigned to you on page and use the $p-1$ method to find one factor of $c$. You may assume that $c-1$ factorises into primes of $size < 100$.
		\begin{flushleft}
			\textbf{\textit{Answer:}}
            \begin{align*}
                &N = 500657\\
                &\text{Set } L = [2,3,2,5,7,2,3,11,13,2,17,19,23,5,3,29,31,2,37,41,\\
                &\hfill 43,47,49,53,59,61,2,67,71,73,79,3,83,89,97]\\
                &a = 3
            \end{align*}
            \begin{table}[H]
                \begin{adjustbox}{scale=1.2,center}
                    \begin{tabular}{ |l|l|l|l| }
                        \hline
                        \textbf{num} & \textbf{a} &\textbf{$ b = a^{num} \tpmod{N}$} & \textbf{gcd(b - 1, N)} \Tstrut\\
                        \hline
                        2 &         3 &         9 &    1\\\hline
                        3 &         9 &       729 &    1\\\hline
                        2 &       729 &     30784 &    1\\\hline
                        5 &     30784 &    131942 &    1\\\hline
                        7 &    131942 &    388833 &    1\\\hline
                        2 &    388833 &    197744 &    1\\\hline
                        3 &    197744 &    261270 &    1\\\hline
                        11 &    261270 &     18971 &    1\\\hline
                        13 &     18971 &    275059 &    1\\\hline
                        2 &    275059 &    170269 &    1\\\hline
                        17 &    170269 &    138053 &    1\\\hline
                        19 &    138053 &    381008 &    1\\\hline
                        23 &    381008 &     73825 &    1\\\hline
                        5 &     73825 &    438038 &  101\\\hline
                    \end{tabular}
                \end{adjustbox}
                \caption{Pollard's P-1 Factorisation}
                \label{table:pollards-p-1}
            \end{table}
            Hence the smallest factor of $500657$ is $101$ \qed

            The Rust code for generating the above result is below.
            \begin{lstlisting}[
                style={mystyle},
                caption={Pollard's P-1 Factorisation},
                label={lst:pollards p-1}
                ]
             pub fn pollards_p_1(n: &BigInt, mut a: BigInt) {
                 if miller_rabin_primality(n) {
                     println!("{} is a prime", &n);
                     return;
                 }
                 // This list need to be generated dynamically.
                 // Static it is for now.
                 let prime_powers: Vec<BigInt> = vec![
                 BigInt::from(2u64),
                 BigInt::from(3u64),
                 BigInt::from(2u64),
                 BigInt::from(5u64),
                 BigInt::from(7u64),
                 BigInt::from(2u64),
                 BigInt::from(3u64),
                 BigInt::from(11u64),
                 BigInt::from(13u64),
                 BigInt::from(2u64),
                 BigInt::from(17u64),
                 BigInt::from(19u64),
                 BigInt::from(23u64),
                 BigInt::from(5u64),
                 BigInt::from(3u64),
                 BigInt::from(29u64),
                 BigInt::from(31u64),
                 BigInt::from(2u64),
                 BigInt::from(37u64),
                 BigInt::from(41u64),
                 BigInt::from(43u64),
                 BigInt::from(47u64),
                 BigInt::from(49u64),
                 BigInt::from(53u64),
                 BigInt::from(59u64),
                 BigInt::from(61u64),
                 BigInt::from(2u64),
                 BigInt::from(67u64),
                 BigInt::from(71u64),
                 BigInt::from(73u64),
                 BigInt::from(79u64),
                 BigInt::from(3u64),
                 BigInt::from(83u64),
                 BigInt::from(89u64),
                 BigInt::from(97u64),
                 ];

                 for num in prime_powers.iter() {
                     let b = modular_pow(&a, num, n);
                     let gcd = n.gcd_euclid(&(&b - BigInt::one()));
                     println!("{:>10} {:>10} {:>10} {:>5}",
                            num, &a, &b, gcd);
                     if &gcd > &BigInt::one() {
                         break;
                     }
                     a = b;
                 }
             }

            \end{lstlisting}

		\end{flushleft}
		\item Take the number $d$ assigned to you on page and use the $p-1$ method to find both factors of $d$. You may NOT use the maple procedure provided in weblearn.
		\begin{flushleft}
			\textbf{\textit{Answer:}} $d = 23861$
            \begin{enumerate}[i.]
                \item
                \begin{align*}
                    &i = 2, a = 2, b = a^i \tpmod{d} = 2^2 \tpmod{23861} = 4, \\
                    &23861 = 7953 \times 3 + 2, 3 = 1 \times 2 + 1 \implies gcd = 1\\
                \end{align*}
                \item
                \begin{align*}
                    &i = 3, a = 4, b = 4^3 \tpmod{23861} = 64, \\
                    &23861 = 378 \times 63 + 47, 63 = 1 \times 47 + 16, 47 = 2 \times 16 + 15, 16 = 1\times15 + 1\\
                    &\implies gcd = 1
                \end{align*}
                \item
                \begin{align*}
                    &i = 2, a = 64, b = 64^2 \tpmod{23861} = 4096,\\
                    &23861 = 5\times4095 + 3386, 4095 = 1\times3386 + 709, 3386 = 4\times709 + 550, \\
                    &709 = 1\times550 + 159\\
                    &550 = 3\times159 + 73, 159 = 2\times73 + 13, 73 = 5\times13 + 8, \\
                    &13 = 1\times8 + 5, 8 = 1\times5 + 3, \\
                    &5 = 1\times3 + 2, 3 = 1\times2 + 1 \implies gcd = 1
                \end{align*}
                \item
                \begin{align*}
                    &i = 5, a = 4096, b = 4096^5\tpmod{23861} = 17634\\
                    &\text{Calculating gcd takes too much time. Hence I used the gcd calc and modular power calc I developed for this assignment}\\
                    &gcd(23861, 17633) = 1
                \end{align*}
                \item
                \begin{align*}
                    &i = 7, a = 17634, b = 17634^7\tpmod{23861} = 8861\\
                    &gcd(23861, 17633) = 1
                \end{align*}
                \item
                \begin{align*}
                    &i = 2, a = 8861, b = 8861^2\tpmod{23861} =14631\\
                    &gcd(23861, 14630) = 1
                \end{align*}
                \item
                \begin{align*}
                    &i = 3, a = 14631, b = 14631^3\tpmod{23861} = 7152\\
                    &gcd(23861, 7151) = 1
                \end{align*}
                \item
                \begin{align*}
                    &i = 11, a = 7152, b = 17643^11\tpmod{23861} = 10163\\
                    &gcd(23861, 10162) = 1
                \end{align*}
                \item
                \begin{align*}
                    &i = 13, a = 10163, b = 10163^13\tpmod{23861} = 2401\\
                    &gcd(23861, 2400) = 1
                \end{align*}
                \item
                \begin{align*}
                    &i = 2, a = 2401, b = 2401^2\tpmod{23861} = 14300\\
                    &gcd(23861, 14299) = 1
                \end{align*}
                \item
                \begin{align*}
                    &i = 17, a = 14300, b = 14300^17\tpmod{23861} = 10052\\
                    &gcd(23861, 10051) = 1
                \end{align*}
                \item
                \begin{align*}
                    &i = 19, a = 10052, b = 10052^19\tpmod{23861} = 23584\\
                    &gcd(23861, 23583) = 1
                \end{align*}
                \item
                \begin{align*}
                    &i = 23, a = 23584, b = 23584^23\tpmod{23861} = 10069\\
                    &gcd(23861, 10068) = 1
                \end{align*}
                \item
                \begin{align*}
                    &i = 5, a = 10069, b = 10069^5\tpmod{23861} = 9432\\
                    &gcd(23861, 9431) = 1
                \end{align*}
                \item
                \begin{align*}
                    &i = 3, a = 9432, b = 9432^3\tpmod{23861} = 20788\\
                    &gcd(23861, 20787) = 1
                \end{align*}
                \item
                \begin{align*}
                    &i = 29, a = 20788, b = 20788^29\tpmod{23861} = 15228\\
                    &gcd(23861, 15227) = 1
                \end{align*}
                \item
                \begin{align*}
                    &i = 31, a = 15228, b = 15228^31\tpmod{23861} = 20741\\
                    &gcd(23861, 20740) = 1
                \end{align*}
                \item
                \begin{align*}
                    &i = 2, a = 20741, b = 20741^2\tpmod{23861} = 22973\\
                    &gcd(23861, 22972) = 1
                \end{align*}
                \item
                \begin{align*}
                    &i = 37, a = 20741, b = 20741^37\tpmod{23861} = 3792\\
                    &gcd(23861, 3791) = 223 > 1 \implies 223|23861 \text{and is one of the factors}\\
                    &23861/223 = 107 \implies \text{107 is the other factor}\\
                    &23861 = 107 \times 223 \qedn
                \end{align*}
           \end{enumerate}
		\end{flushleft}
		\item Take the same number d and now factorise using the Quadratic Sieve method. You may use Maple commands included in the week 10 workshop folder.

		\begin{flushleft}
			\textbf{\textit{Answer:}} $d = 23861$\\
            \begin{enumerate}[Step 1.]
                \item We use the polynomial $y(x) = x^2 - d$ to find the B-smooth numbers. We initialise $x = \sqrt{500657}$ to start the sieve. Calculate the square root of $d$.\\
                $a = \lfloor\sqrt{23861}\rfloor = 154$\\
                We then $y(x), y(x + 1), y(x + 2), ...$
                \item Calculate the factor base. Euler's criteria for odd primes to determine whether a number is a quadratic residue or not is in action here. We got the below Factor Base: \\
                $\{2, 5, 19, 29\}$. We added $-1$ to it to consider negative values too. Hence the Factor Base became $\{-1, 2, 5, 19, 29\}$
                \item Calculate $y(x)$ and sieve the B-smooth numbers. Here we set $B = 4$.
                \item the table below shows the sieved numbers and the corresponding exponents matrix (I wrote some Rust code to \ref{lst:qudratic-sieve} generate these values.)
                \begin{table}[H]
                    \begin{adjustbox}{scale=1.2,center}
                        \begin{tabular}{ |l|l|l|l|l|l|l|l|l| }
                            \hline
                            \textbf{x} & \textbf{y(x + a)} & \textbf{-1} & \textbf{2} & \textbf{5} & \textbf{19} & \textbf{29} & \textbf{37} & \textbf{41} \Tstrut\\
                            \hline
                            -63 & 91   & 1 & 2 & 1 & 1 & 0 & 0 & 1 \\\hline
                            -55 & 99   & 1 & 2 & 1 & 1 & 0 & 1 & 0 \\\hline
                            \rowcolor{SeaGreen3!30!}
                            -25 & 129  & 1 & 2 & 1 & 2 & 0 & 0 & 0 \\\hline
                            -18 & 136  & 1 & 0 & 1 & 0 & 1 & 1 & 0 \\\hline
                            \rowcolor{SeaGreen3!30!}
                            -10 & 144  & 1 & 0 & 5 & 0 & 0 & 0 & 0 \\\hline
                            0 & 154  & 0 & 0 & 1 & 0 & 1 & 0 & 0 \\\hline
                            1 & 155  & 0 & 2 & 0 & 0 & 0 & 0 & 1 \\\hline
                            2 & 156  & 0 & 0 & 2 & 1 & 0 & 0 & 0 \\\hline
                            11 & 165  & 0 & 2 & 0 & 0 & 2 & 0 & 0 \\\hline
                            19 & 173  & 0 & 2 & 0 & 0 & 0 & 1 & 1 \\\hline
                            40 & 194  & 0 & 0 & 2 & 1 & 1 & 0 & 0 \\\hline
                            127 & 281  & 0 & 2 & 2 & 1 & 1 & 0 & 0 \\\hline
                            165 & 319  & 0 & 2 & 2 & 1 & 0 & 0 & 1 \\\hline
                            \multicolumn{2}{|r|}{Selected Rows' sum} & 2 & 2 & 6 & 2 & 0 & 0 & 0 \\
                            \hline
                            \multicolumn{2}{|r|}{Values for $v$} & 1 & 1 & 3 & 1 & 0 & 0 & 0 \\
                            \hline
                        \end{tabular}
                    \end{adjustbox}
                    \caption{Quadratic Sieve Factorisation}
                    \label{table:qudratic-field-sieve}
                \end{table}
                \item We calculate $v$ and $u$ as follows:
                \begin{align*}
                    &u = 129 \times 144 \tpmod{23861} \\
                    &  = 18576 \\
                    &v = -1 \times 2 \times 5^3 \times 19 \tpmod{23861} \\
                    &  = 19111\\
                    & u^2 \equiv v^2 \tpmod{23861} \implies gcd(d, u-v) and gcd(d, u+v) are factors of d\\
                    & gcd(23861, 19111 - 18576) = 107 \\
                    & gcd(23861, 19111 + 18576) = 223\\\
                    &   \therefore 23861 = 101 \times 223
                    \hfill\qedn
                \end{align*}
                \item The Rust code for generating the above result is below.
                \begin{lstlisting}[
                style={mystyle},
                caption={Quadratic Sieve},
                label={lst:qudratic-sieve}
                ]

pub fn prepare_matrix(n: &BigInt) {
    let mut primes = vec![BigInt::from(2u64)];
    let a = n.sqrt();
    println!("Square Root of {} = {}", n, a);

    let mut factor_base = vec![
    BigInt::from(2u64),
    BigInt::from(5u64),
    BigInt::from(7u64),
    BigInt::from(11u64),
    BigInt::from(13u64),
    BigInt::from(17u64),
    BigInt::from(19u64),
    BigInt::from(23u64),
    BigInt::from(29u64),
    BigInt::from(31u64),
    BigInt::from(37u64),
    BigInt::from(41u64),
    ];

    println!("Legendre Symbol is calculated using Euler's criteria: ");
    println!("If n^(p-1)/2 (mod p) = 1,
               then (n/p) = 1, else (n/p) = -1");
    factor_base
       .retain(|x| modular_pow(n, &((x - 1) / BigInt::from(2u64)),
                x) == BigInt::one());
    //factor_base.insert(0, BigInt::from(-1i32));
    println!("The calculated Factor Base is: {:?}", &factor_base);
    let mut y_x: Vec<BigInt> = Vec::new();
    // start = sqrt(n) - 100, end = sqrt(n) + 200
    // These values should be dynamic
    let start = a.clone() - BigInt::from(100u64);
    let end = a.clone() + BigInt::from(200u64);

    let mut m_by_n: Vec<Vec<i32>> = Vec::new();
    for i in range_inclusive(start, end) {
        let x = &i - &a;
        y_x.push(x.clone());
        // y(x) = (x + a)^2 - n
        let mut y = &i * &i - n;
        if y.sign() == Sign::Minus {
            y = -1 * y;
        }
        let p_factors = y.prime_factors(&mut primes).clone();
        let p_factors_map: HashMap<BigInt, i32> = p_factors
        .iter()
        .cloned()
        .map(|(p, e)| (p, e as i32))
        .collect();
        let distinct_factors = p_factors
        .iter()
        .map(|x| x.0.clone())
        .collect::<Vec<BigInt>>();
        let set1: HashSet<BigInt> = factor_base
               .iter().cloned().collect();
        let set2: HashSet<BigInt> = distinct_factors
               .iter().cloned().collect();

        if set2.is_subset(&set1) {
            // println!("{} {} {:?}", i - &a, &y, p_factors);

            let mut one_by_n: Vec<i32> = Vec::new();
            for base in factor_base.iter() {
                if set2.contains(&base) {
                    let e = p_factors_map.get(&base).unwrap();
                    one_by_n.push(e.clone());
                } else {
                    one_by_n.push(0);
                }
            }

            if x.sign() == Sign::Minus {
                one_by_n.insert(0, 1);
            } else {
                one_by_n.insert(0, 0);
            }
            m_by_n.push(one_by_n.clone());
            println!("{:>5} {:>5}  {:?}", x, i, one_by_n);
        }
    }
}
                \end{lstlisting}

                \bigbreak
                We can use the below command to generate the desired matrix:
                \begin{lstlisting}[style=DOS, caption=Quadratic Sieve Matrix Generation]
                ./target/debug/nt-assignments quadratic-sieve -n 23861
                Square Root of 23861 = 154
                Legendre Symbol is calculated using Euler's criteria:
                If n^(p-1)/2 (mod p) = 1, then (n/p) = 1, else (n/p) = -1
                The calculated Factor Base is: [2, 5, 19, 29, 37, 41]
                -63    91  [1, 2, 1, 1, 0, 0, 1]
                -55    99  [1, 2, 1, 1, 0, 1, 0]
                -25   129  [1, 2, 1, 2, 0, 0, 0]
                -18   136  [1, 0, 1, 0, 1, 1, 0]
                -10   144  [1, 0, 5, 0, 0, 0, 0]
                  0   154  [0, 0, 1, 0, 1, 0, 0]
                  1   155  [0, 2, 0, 0, 0, 0, 1]
                  2   156  [0, 0, 2, 1, 0, 0, 0]
                 11   165  [0, 2, 0, 0, 2, 0, 0]
                 19   173  [0, 2, 0, 0, 0, 1, 1]
                 40   194  [0, 0, 2, 1, 1, 0, 0]
                127   281  [0, 2, 2, 1, 1, 0, 0]
                165   319  [0, 2, 2, 1, 0, 0, 1]
                \end{lstlisting}
            \end{enumerate}
		\end{flushleft}

		\item The Maple worksheet in Weblearn for this assignment shows part of an attempt to factorise $N = 9263 = 59*157$ using the Number Field Sieve. In this we claim the following:
		\begin{enumerate}[i.]
			\item $A = [0 , 1, 0]$ is a prime(irreducible) element of $Z(\sqrt[3]{-2})$  with $norm = 2$
			\item $B = [-1 ,-1, 0]$ is a prime(irreducible) element of $Z(\sqrt[3]{-2})$  with $norm = 3$
			\item $C = [1, 0 , 1]$ is a prime(irreducible) element of $Z(\sqrt[3]{-2})$  with $norm = 5$
			\item $D = [1 , 1, -1]$ is a prime(irreducible) element of $Z(\sqrt[3]{-2})$  with $norm = 11$
			\item $E = [1 , -2, 0]$ is a prime(irreducible) element of $Z(\sqrt[3]{-2})$  with $norm = 17$
			\item $F = [3 , 0, -1]$ is a prime(irreducible) element of $Z(\sqrt[3]{-2})$  with $norm = 23$
		\end{enumerate}
		We also derive a $48 \times 15$ matrix $R$ consisting of values of $a$ and $b$ such that $a + 21b$ can be factorised using small primes and $[a, b, 0]$ can be factorised in $Z(\sqrt[3]{-2})$ using just the primes $\{A, B, C, D, E, F\}$ and a unit element $U = [1, 1, 0]$.
		\begin{enumerate}[a.]
			\item Prove the statement above allocated to you on page 1 using the definition of a norm.
			\begin{flushleft}
                \textbf{\textit{Answer:}} Norm is defined as the product of all the conjugates of the minimum polynomial in the field. i,e. in the For the polynomial $f(x) = x^3 + 2$, the roots are $\theta = \{\sqrt[3]{-2}, \theta.\frac{(-1 + i\sqrt{3})}{2}, \theta.\frac{(-1 - i\sqrt{3})}{2}\}$. Hence the algebraic integers in $Z(\sqrt[3]{-2})$ are of the form $a + b\theta + c\theta^2$. We represent these integers as $[a, b, c]$. The norm is defined as:
                \begin{align*}
                    &N[a, b, c] = a^3 - 2b^3 + 4c^3 + 6abc.
                    &\text{hence in our case, } [a, b, c] = [-1 , -1, 0]
                    &\implies N([a, b, c]) = -1 + 2 = 1
                    &\implies the given statement is wrong.
                \end{align*}
                Since the $norm = 1$, the given element $B = [-1, -1, 0]$ is a $unit$ in $Z(\sqrt[3]{-2})$, not a prime. $\square$
            \end{flushleft}
            \item Show that rows 23, 37, 41 and 45 of the matrix  form a linearly dependent set modulo 2
            \begin{flushleft}
                \textbf{\textit{Answer:}} The rows 23, 37, 41, 45 in matrix form is:\\

                \bigbreak
                $A_{4\times15} = \begin{pmatrix}
                    0 & 1 & 1 & 0 & 1 & 0 & 0 & 1 & 0 & 4 & 0 & 0 & 0 & 0 & 0\\
                    0 & 1 & 1 & 0 & 0 & 0 & 0 & 1 & 1 & 3 & 3 & 0 & 0 & 0 & 0\\
                    0 & 1 & 0 & 1 & 1 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 0 & 2 & 0\\
                    0 & 5 & 0 & 1 & 0 & 0 & 0 & 1 & 0 & 9 & 1 & 0 & 0 & 0 & 0
                \end{pmatrix}$

                \medbreak
                $A \tpmod{2}$ gives,
                $A = \begin{pmatrix}
                    0 & 1 & 1 & 0 & 1 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                    0 & 1 & 1 & 0 & 0 & 0 & 0 & 1 & 1 & 1 & 1 & 0 & 0 & 0 & 0\\
                    0 & 1 & 0 & 1 & 1 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 0 & 0 & 0\\
                    0 & 1 & 0 & 1 & 0 & 0 & 0 & 1 & 0 & 1 & 1 & 0 & 0 & 0 & 0
                \end{pmatrix}$
                \medbreak
                Performing row operations on $A$ to find the Row Echelon form:\\
                R2 = R2 + R1,\\
                R3 = R3 + R1,\\
                R4 = R4 + R1:\\
                $B = \begin{pmatrix}
                    0 & 1 & 1 & 0 & 1 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                    0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 1 & 1 & 1 & 0 & 0 & 0 & 0\\
                    0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0\\
                    0 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 0
                \end{pmatrix}$
                \medbreak
                Swap R2 and R4\\
                $B = \begin{pmatrix}
                    0 & 1 & 1 & 0 & 1 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                    0 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 0\\
                    0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0\\
                    0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 1 & 1 & 1 & 0 & 0 & 0 & 0
               \end{pmatrix}$
               \medbreak
               R3 = R3 + R2\\
               $B = \begin{pmatrix}
                    0 & 1 & 1 & 0 & 1 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                    0 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 0\\
                    0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 1 & 1 & 1 & 0 & 0 & 0 & 0\\
                    0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 1 & 1 & 1 & 0 & 0 & 0 & 0
               \end{pmatrix}$
               \medbreak
               R3 and R4 are the same, R4 is a linear combination of the row R4. Hence the matrix becomes:\\
               $B = \begin{pmatrix}
                    0 & 1 & 1 & 0 & 1 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                    0 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 0\\
                    0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 1 & 1 & 1 & 0 & 0 & 0 & 0\\
                    0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
               \end{pmatrix}$
               \medbreak
               Hence the $rank(A) = 3$ (the number of leading 1's in the $B$) which is less than the number of rows in $A$ and that implies $A$ that the row vectors that form the matrix $A$ are linearly dependent. $\square$

            \end{flushleft}

            \item Hence find an equation of the form u2 – v2 such that u2 – v2 and N have a common factor of 59 thus factorising N. You may use the Maple procedure for multiplication in $Z(\sqrt[3]{-2})$ to help you find u and v.
    		\begin{flushleft}
                \textbf{\textit{Answer:}}
                \begin{align*}
                    & N = 9263  = 21^3 + 2
                    &\text{Hence we can form the polynomial} f(x) = x^3 + 2. \\
                    &\text{An element}\beta \text{ is of the form} (a + b\theta + c\theta^2) \in \mathbb{Z}(\sqrt[3]{-2})\\
                    &\text{The Algebraic Factor Base given is} = \{U = [1, 1, 0], A = [0, 1, 0], B = [-1, 1, 0], C = [1, 0, 1], D = [1, 1,-1], E = [1,-2, 0], F = [3, 0,-1]\} \\
                    &\text{The Rational Factor Base given is } = \{-1, 2, 3, 5, 7,11, 13\}
                \end{align*}

                The below table has the values selected for calculating $u$ and $v$:
                \begin{table}[H]
                    \begin{adjustbox}{scale=0.9,center}
                        \begin{tabular}{ |l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l| }
                            \hline
                            \textbf{a} & \textbf{b} & \textbf{a+21b} & \textbf{-1} & \textbf{2} & \textbf{3} & \textbf{5} & \textbf{7} & \textbf{11} & \textbf{13} & \textbf{-1} & \textbf{U} & \textbf{A} & \textbf{B} & \textbf{C} & \textbf{D} & \textbf{E} & \textbf{F} \Tstrut\\
                            \hline
                            0 & 2   & 42  & 0 & 1 & 1 & 0 & 1 & 0 & 0 & 1 & 0 & 4 & 0 & 0 & 0 & 0 & 0 \\
                            \hline
                            6 & 0   & 6  & 0 & 1 & 1 & 0 & 0 & 0 & 0 & 1 & 1 & 3 & 3 & 0 & 0 & 0 & 0 \\
                            \hline
                            7 & 3   & 70  & 0 & 1 & 0 & 1 & 1 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 0 & 2 & 0 \\
                            \hline
                            -8 & 8   & 160  & 0 & 5 & 0 & 1 & 0 & 0 & 0 & 1 & 0 & 9 & 1 & 0 & 0 & 0 & 0 \\
                            \hline
                            \multicolumn{3}{|l|}{Sum Of Rows} & 0 & 10 & 2 & 2 & 2 & 0 & 0 & 4 & 2 & 16 & 4 & 0 & 0 & 2 & 0 \\
                            \hline
                        \end{tabular}
                    \end{adjustbox}
                    \caption{Number Field Sieve Factorisation}
                    \label{table:number-field-sieve}
                \end{table}

                Calculating the $v$ value by multiplying the rational factor bases with halved \\
                values from the Sum Row: $v = 2^5 \times 3 \times 5 \times 7 = 1680$ \\
                Calculating the $u$ value by multiplying the algebraic factor bases with halved \\
                values from the Sum Row:
                \begin{align*}
                    \beta = &[a, b, c] \\
                    = &U \times A^8 \times B^2 \times E \\
                    = &[1, 1, 0] \times [0, 1, 0]^8 \times [-1, 1, 0] \times [-1, 1, 0] \times [1, -2, 0]\\
                \end{align*}
                We get value for $u$ after substituting for $a$, $b$, $c$ in $a + b\theta + c\theta^2$ where $\theta = 21$.\\
                $u = -8 + 21 \times -8 + 21^2 \times -20 = -8996$\\
                $u^2 = 6448\tpmod{9263}, u^2 = 6448 \tpmod{9263}$\\

                And we get $v^2 \equiv u^2 \tpmod{9263}$ \\
                \medbreak
                Calculating gcd to find the factors:
                \begin{align*}
                gcd(9263, 1680 + 8996) = 157\\
                gcd(9263, 1680 - 8996) = 59\\
                \text{Hence, N is factorised as } N = 9263 = 59 \times 157
                \hfill\qedn
                \end{align*}
                \bigbreak
                The Maple calculation performed is given below:
                \begin{mdframed}
                \mapleinput
                {$ \displaystyle \texttt{>\,}  $}

                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{norm1} \coloneqq \mathrm{proc}(a ,b ,c)\,\mathrm{global}\,k ;\,k \coloneqq a^{3}-2\cdot b^{3}+4\cdot c^{3}+6\cdot a \cdot b \cdot c ;\mathrm{end}; $}

                % \mapleresult
                \begin{dmath}\label{(2)}
                    -10258
                \end{dmath}

                \mapleinput
                {$ \displaystyle \texttt{>\,} \,U \coloneqq [1,1,0];A \coloneqq [0,1,0];B \coloneqq [-1,1,0];C \coloneqq [1,0,1];\mathit{D1} \coloneqq [1,1,-1];E \coloneqq [1,-2,0];F \coloneqq [3,0,-1]; $}

                % \mapleresult
                \begin{dmath*}
                    U \coloneqq \left[1,1,0\right]
                \end{dmath*}
                \vspace{-\bigskipamount}
                % \mapleresult
                \begin{dmath*}
                    A \coloneqq \left[0,1,0\right]
                \end{dmath*}
                \vspace{-\bigskipamount}
                % \mapleresult
                \begin{dmath*}
                    B \coloneqq \left[-1,1,0\right]
                \end{dmath*}
                \vspace{-\bigskipamount}
                % \mapleresult
                \begin{dmath*}
                    C \coloneqq \left[1,0,1\right]
                \end{dmath*}
                \vspace{-\bigskipamount}
                % \mapleresult
                \begin{dmath*}
                    \mathit{D1} \coloneqq \left[1,1,-1\right]
                \end{dmath*}
                \vspace{-\bigskipamount}
                % \mapleresult
                \begin{dmath*}
                    E \coloneqq \left[1,-2,0\right]
                \end{dmath*}
                \vspace{-\bigskipamount}
                % \mapleresult
                \begin{dmath}\label{(4)}
                    F \coloneqq \left[3,0,-1\right]
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} \,\mathit{mult1} \coloneqq \mathrm{proc}(x ,y);\,\mathit{mult2} (x [1],x [2],x [3],y [1],y [2],y [3])\,;\mathrm{end};\, $}


                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{mult4} \coloneqq \mathrm{proc}()\mathrm{global}\,L ;\,L \coloneqq [];\,
                    \mathrm{for}\,i \,\mathrm{from}\,1\,\mathrm{to}\,\mathit{nargs} \,\\
                           \mathrm{do}\,L \coloneqq [\mathit{op} (L),\mathit{args} [i]];\mathrm{od};\,\\
                           \mathrm{if}\,\mathit{nops} (L)=2\,\mathrm{then}\,\\
                            \mathit{mult1} (\mathit{op} (1,L),\mathit{op} (2,L))\,
                            \mathrm{else}\,k \coloneqq [\mathit{mult1} (\mathit{op} (1,L),\mathit{op} (2,L))];L\\
                            \coloneqq \mathit{subsop} (1=\mathit{NULL} ,L);\,L \coloneqq \mathit{subsop} (1=\mathit{NULL} ,L);L \coloneqq [k ,\mathit{op} (L)];\,\mathit{mult4} (\mathit{op} (L));
                    \mathrm{fi};
                    \mathrm{end}; $}

                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{mult4} (U ,U ,B ,E); $}

                % \mapleresult
                \begin{dmath}\label{(7)}
                    1,5,3
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} H \coloneqq \mathit{mult4} (U ,A ,A ,A); $}

                % \mapleresult
                \begin{dmath}\label{(8)}
                    H \coloneqq -2,-2,0
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,}  $}

                \mapleinput
                {$ \displaystyle \texttt{>\,} H \coloneqq [-2,-2,0]; $}

                % \mapleresult
                \begin{dmath}\label{(9)}
                    H \coloneqq \left[-2,-2,0\right]
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{mult4} (H ,A ,A ,A); $}

                % \mapleresult
                \begin{dmath}\label{(10)}
                    4,4,0
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} H \coloneqq [4,4,0]; $}

                % \mapleresult
                \begin{dmath}\label{(11)}
                    H \coloneqq \left[4,4,0\right]
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{mult4} (H ,A ,A ,B); $}

                % \mapleresult
                \begin{dmath}\label{(12)}
                    0,-8,-4
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} H \coloneqq [0,-8,-4]; $}

                % \mapleresult
                \begin{dmath}\label{(13)}
                    H \coloneqq \left[0,-8,-4\right]
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{mult4} (U ,H ,B ,E); $}

                % \mapleresult
                \begin{dmath}\label{(14)}
                    32,-16,-28
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} M \coloneqq \mathit{mult1} (0,-8,-4,-1,1,0); $}

                % \mapleresult
                \begin{dmath}\label{(15)}
                    M \coloneqq 0,0,0
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{mult1} (0,0,0,1,-2,0); $}

                % \mapleresult
                \begin{dmath}\label{(16)}
                    0,0,0
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} \, $}
                \begin{Maple Normal}


                    \

                    U*A^8*B^2*E =
                    {$ [1,1,0]\cdot [0,1,0]\cdot [0,1,0]\cdot [0,1,0]\cdot [0,1,0]\cdot [0,1,0]\cdot [0,1,0]\cdot [0,1,0]\cdot [0,1,0]\cdot [-1,1,0]\cdot [-1,1,0]\cdot [1,-2,0]; $}
                \end{Maple Normal}
                \mapleinput
                {$ \displaystyle \texttt{>\,}  $}

                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{mult1} (U ,A); $}

                % \mapleresult
                \begin{dmath}\label{(17)}
                    0,1,1
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{UA} \coloneqq [0,1,1]; $}

                % \mapleresult
                \begin{dmath}\label{(18)}
                    \mathit{UA} \coloneqq \left[0,1,1\right]
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{mult1} (\mathit{UA} ,A); $}

                % \mapleresult
                \begin{dmath}\label{(19)}
                    -2,0,1
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{UAA} \coloneqq [-2,0,1]; $}

                % \mapleresult
                \begin{dmath}\label{(20)}
                    \mathit{UAA} \coloneqq \left[-2,0,1\right]
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{mult1} (\mathit{UAA} ,A); $}

                % \mapleresult
                \begin{dmath}\label{(21)}
                    -2,-2,0
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{UAAA} \coloneqq [-2,-2,0]; $}

                % \mapleresult
                \begin{dmath}\label{(22)}
                    \mathit{UAAA} \coloneqq \left[-2,-2,0\right]
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{mult1} (\mathit{UAAA} ,A); $}

                % \mapleresult
                \begin{dmath}\label{(23)}
                    0,-2,-2
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{UAAAA} \coloneqq [0,-2,-2]; $}

                % \mapleresult
                \begin{dmath}\label{(24)}
                    \mathit{UAAAA} \coloneqq \left[0,-2,-2\right]
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{mult4} (\mathit{UAAAA} ,A ,A ,A); $}

                % \mapleresult
                \begin{dmath}\label{(25)}
                    0,4,4
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{UAAAAAAA} \coloneqq [0,4,4]; $}

                % \mapleresult
                \begin{dmath}\label{(26)}
                    \mathit{UAAAAAAA} \coloneqq \left[0,4,4\right]
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{mult4} (\mathit{UAAAAAAA} ,A); $}

                % \mapleresult
                \begin{dmath}\label{(27)}
                    -8,0,4
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{UA8} \coloneqq [-8,0,4]; $}

                % \mapleresult
                \begin{dmath}\label{(28)}
                    \mathit{UA8} \coloneqq \left[-8,0,4\right]
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{mult4} (\mathit{UA8} ,B ,B ,E); $}

                % \mapleresult
                \begin{dmath}\label{(29)}
                    -8,-8,-20
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} \, $}

                \begin{Maple Normal}
                    u = phi(a + bz + cz^2) = a + 21b + 21^2c = -8 + 21*-8 + 21^2 * -20 = -8996\
                    v = 2^4*3*5*7 = 1680
                    v^2 mod 9263 = 6448
                \end{Maple Normal}
                \begin{Maple Normal}
                    u^2 mod 9263 = 6448
                \end{Maple Normal}

                \begin{Maple Normal}
                    gcd(9263, 1680 + 8996) =  157

                    gcd(9263, 1680 - 8996) =  59
                \end{Maple Normal}
                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{igcd} (9263,10676); $}

                % \mapleresult
                \begin{dmath}\label{(30)}
                    157
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{igcd} (9263,7316); $}

                % \mapleresult
                \begin{dmath}\label{(31)}
                    59
                \end{dmath}
                \mapleinput
                {$ \displaystyle \texttt{>\,} \mathit{ifactor} (9263); $}

                % \mapleresult
                \begin{dmath}\label{(32)}
                    \left(59\right) \left(157\right)
                \end{dmath}
            \end{mdframed}
            \end{flushleft}
        \end{enumerate}

		\item Compare the methods for integer factorisation you have seen in the module and summarises their strengths and weaknesses, including the size of numbers that can be factorised, usability and whether or not they work for a broad range of numbers.
	\end{enumerate}

	\begin{thebibliography}{unsrt}

		\bibitem{Modular_Mathematics}
		C R Jordan \& D A Jordan \emph{MODULAR MATHEMATICS Groups }.

		\bibitem{gt_solutions}
		Dr. Ben Fairbairn \emph{GROUP THEORY Solutions to Exercises}.

		\bibitem{online_ref_1}
		\emph{https://github.com/Ssophoclis/AKS-algorithm/blob/master/AKS.py}

	\end{thebibliography}

\end{document}